---
description: 
globs: 
alwaysApply: false
---
以下因子均可从表中直接提取，并可作为量化模型的输入。为了便于理解，下面按照**因子类别**进行分类标注，并列出对应的字段名称及含义。若模型训练中只需使用一种复权方式，可优先选取“后复权”字段（以“\_hfq”结尾）；以下说明中也会同时列出“不复权（\_bfq）”和“前复权（\_qfq）”的对照。

---

## 1. 基础行情类因子

这些因子直接反映股票当日的价格情况，常用来计算收益率、价格波动等。

* **开盘价**

  * `open`：当日开盘价（不复权）
  * `open_hfq`：当日开盘价（后复权）
  * `open_qfq`：当日开盘价（前复权）
* **最高价**

  * `high`：当日最高价（不复权）
  * `high_hfq`：当日最高价（后复权）
  * `high_qfq`：当日最高价（前复权）
* **最低价**

  * `low`：当日最低价（不复权）
  * `low_hfq`：当日最低价（后复权）
  * `low_qfq`：当日最低价（前复权）
* **收盘价**

  * `close`：当日收盘价（不复权）
  * `close_hfq`：当日收盘价（后复权）
  * `close_qfq`：当日收盘价（前复权）
* **昨收价**

  * `pre_close`：前一交易日收盘价（不复权）
* **涨跌额与涨跌幅**

  * `change`：收盘价与昨收价之差（涨跌额）
  * `pct_chg`：当日涨跌幅（%）

---

## 2. 成交量与换手率类因子

这些因子提供交易活跃度、市场参与度的衡量。

* **成交量和成交额**

  * `vol`：当日成交量（手）
  * `amount`：当日成交额（元）
* **换手率**

  * `turnover_rate`：当日换手率（%）
  * `turnover_rate_f`：当日自由流通股换手率（%）
* **量比**

  * `volume_ratio`：当日成交量与过去 N 天平均成交量之比

---

## 3. 估值与基本面类因子

常见的市盈、市净、市销等估值指标，可以反映股票的估值水平。

* **市盈率（P/E）**

  * `pe`：静态市盈率（TTM 之外的常规估值）
  * `pe_ttm`：滚动市盈率（TTM）
* **市净率（P/B）**

  * `pb`：市净率
* **市销率（P/S）**

  * `ps`：静态市销率
  * `ps_ttm`：滚动市销率（TTM）
* **股息率（Dividend Yield）**

  * `dv_ratio`：静态股息率
  * `dv_ttm`：滚动股息率（TTM）

---

## 4. 股本与市值类因子

反映公司规模与资本结构情况。

* **股本规模**

  * `total_share`：公司总股本（股）
  * `float_share`：流通股本（股）
  * `free_share`：自由流通股本（扶持）
* **市值规模**

  * `total_mv`：总市值（元）
  * `circ_mv`：流通市值（元）
* **复权因子**

  * `adj_factor`：当日复权因子（用于从不复权价格计算复权价格）

---

## 5. 连续交易行为类因子

描述股票在趋势上的持续表现情况。

* **连续涨跌天数**

  * `updays`：连续上涨交易日天数
  * `downdays`：连续下跌交易日天数
* **连续创高与创低天数**

  * `topdays`：距最近一次最高价已持续的交易日天数
  * `lowdays`：距最近一次最低价已持续的交易日天数

---

## 6. 趋势类技术指标

反映价格趋势方向与强度的指标，常用来判断多空力量对比。

1. **移动平均线类**

   * **简单移动平均（MA）**

     * `ma_bfq_5`、`ma_bfq_10`、`ma_bfq_20`、`ma_bfq_30`、`ma_bfq_60`、`ma_bfq_90`、`ma_bfq_250`（不复权）
     * `ma_hfq_5`、`ma_hfq_10`、`ma_hfq_20`、`ma_hfq_30`、`ma_hfq_60`、`ma_hfq_90`、`ma_hfq_250`（后复权）
     * `ma_qfq_5`、`ma_qfq_10`、`ma_qfq_20`、`ma_qfq_30`、`ma_qfq_60`、`ma_qfq_90`、`ma_qfq_250`（前复权）
   * **指数移动平均（EMA）**

     * `ema_bfq_5`、`ema_bfq_10`、`ema_bfq_20`、`ema_bfq_30`、`ema_bfq_60`、`ema_bfq_90`、`ema_bfq_250`（不复权）
     * `ema_hfq_5`、`ema_hfq_10`、`ema_hfq_20`、`ema_hfq_30`、`ema_hfq_60`、`ema_hfq_90`、`ema_hfq_250`（后复权）
     * `ema_qfq_5`、`ema_qfq_10`、`ema_qfq_20`、`ema_qfq_30`、`ema_qfq_60`、`ema_qfq_90`、`ema_qfq_250`（前复权）
   * **飞鹰平行线（DFMA）**

     * `dfma_dif_bfq`、`dfma_difma_bfq`（DIF 与 DIFMA 不复权）
     * `dfma_dif_hfq`、`dfma_difma_hfq`（后复权）
     * `dfma_dif_qfq`、`dfma_difma_qfq`（前复权）
   * **双重指数平均（TRIX & TRMA）**

     * `trix_bfq`、`trma_bfq`（TRIX、TRMA 不复权）
     * `trix_hfq`、`trma_hfq`（后复权）
     * `trix_qfq`、`trma_qfq`（前复权）
   * **BBI 多空指标**

     * `bbi_bfq`（不复权）
     * `bbi_hfq`（后复权）
     * `bbi_qfq`（前复权）
   * **动向指标 DMI（Directional Movement Index）**

     * `dmi_adx_bfq`、`dmi_adxr_bfq`、`dmi_pdi_bfq`、`dmi_mdi_bfq`（不复权）
     * `dmi_adx_hfq`、`dmi_adxr_hfq`、`dmi_pdi_hfq`、`dmi_mdi_hfq`（后复权）
     * `dmi_adx_qfq`、`dmi_adxr_qfq`、`dmi_pdi_qfq`、`dmi_mdi_qfq`（前复权）

2. **波动率类指标**

   * **ATR（Average True Range）**

     * `atr_bfq`（不复权）
     * `atr_hfq`（后复权）
     * `atr_qfq`（前复权）
   * **EMV（Ease of Movement） & MAEMV**

     * `emv_bfq`、`maemv_bfq`（不复权）
     * `emv_hfq`、`maemv_hfq`（后复权）
     * `emv_qfq`、`maemv_qfq`（前复权）
   * **MASS 梅斯线 & MA\_MASS**

     * `mass_bfq`、`ma_mass_bfq`（不复权）
     * `mass_hfq`、`ma_mass_hfq`（后复权）
     * `mass_qfq`、`ma_mass_qfq`（前复权）

3. **趋势/区间震荡类**

   * **DPO（Detrended Price Oscillator） & MADPO**

     * `dpo_bfq`、`madpo_bfq`（不复权）
     * `dpo_hfq`、`madpo_hfq`（后复权）
     * `dpo_qfq`、`madpo_qfq`（前复权）
   * **Bollinger 布林带**

     * `boll_lower_bfq`、`boll_mid_bfq`、`boll_upper_bfq`（不复权）
     * `boll_lower_hfq`、`boll_mid_hfq`、`boll_upper_hfq`（后复权）
     * `boll_lower_qfq`、`boll_mid_qfq`、`boll_upper_qfq`（前复权）
   * **唐奇安通道（KTN）**

     * `ktn_down_bfq`、`ktn_mid_bfq`、`ktn_upper_bfq`（不复权）
     * `ktn_down_hfq`、`ktn_mid_hfq`、`ktn_upper_hfq`（后复权）
     * `ktn_down_qfq`、`ktn_mid_qfq`、`ktn_upper_qfq`（前复权）
   * **TAQ 通道**

     * `taq_down_bfq`、`taq_mid_bfq`、`taq_up_bfq`（不复权）
     * `taq_down_hfq`、`taq_mid_hfq`、`taq_up_hfq`（后复权）
     * `taq_down_qfq`、`taq_mid_qfq`、`taq_up_qfq`（前复权）
   * **薛斯通道（XSII）**

     * `xsii_td1_bfq`、`xsii_td2_bfq`、`xsii_td3_bfq`、`xsii_td4_bfq`（不复权）
     * `xsii_td1_hfq`、`xsii_td2_hfq`、`xsii_td3_hfq`、`xsii_td4_hfq`（后复权）
     * `xsii_td1_qfq`、`xsii_td2_qfq`、`xsii_td3_qfq`、`xsii_td4_qfq`（前复权）

---

## 7. 动量与震荡类技术指标

这些指标主要衡量价格超买超卖、动量强弱等。

1. **相对强弱指数（RSI）**

   * `rsi_bfq_6`、`rsi_bfq_12`、`rsi_bfq_24`（不复权）
   * `rsi_hfq_6`、`rsi_hfq_12`、`rsi_hfq_24`（后复权）
   * `rsi_qfq_6`、`rsi_qfq_12`、`rsi_qfq_24`（前复权）

2. **CCI（Commodity Channel Index）**

   * `cci_bfq`（不复权）
   * `cci_hfq`（后复权）
   * `cci_qfq`（前复权）

3. **KDJ 随机指标**

   * `kdj_k_bfq`、`kdj_d_bfq`、`kdj_bfq`（J 值）（不复权）
   * `kdj_k_hfq`、`kdj_d_hfq`、`kdj_hfq`（后复权）
   * `kdj_k_qfq`、`kdj_d_qfq`、`kdj_qfq`（前复权）

4. **威廉指标（WR & WR1）**

   * `wr_bfq`、`wr1_bfq`（不复权）
   * `wr_hfq`、`wr1_hfq`（后复权）
   * `wr_qfq`、`wr1_qfq`（前复权）

5. **心理线指标（PSY & PSYMA）**

   * `psy_bfq`、`psyma_bfq`（不复权）
   * `psy_hfq`、`psyma_hfq`（后复权）
   * `psy_qfq`、`psyma_qfq`（前复权）

6. **BIAS 乖离率**

   * `bias1_bfq`、`bias2_bfq`、`bias3_bfq`（不复权）
   * `bias1_hfq`、`bias2_hfq`、`bias3_hfq`（后复权）
   * `bias1_qfq`、`bias2_qfq`、`bias3_qfq`（前复权）

7. **动量指标（MTM & MTMMA）**

   * `mtm_bfq`、`mtmma_bfq`（不复权）
   * `mtm_hfq`、`mtmma_hfq`（后复权）
   * `mtm_qfq`、`mtmma_qfq`（前复权）

8. **变动率指标（ROC & MAROC）**

   * `roc_bfq`、`maroc_bfq`（不复权）
   * `roc_hfq`、`maroc_hfq`（后复权）
   * `roc_qfq`、`maroc_qfq`（前复权）

9. **CR 价格动量指标**

   * `cr_bfq`（不复权）
   * `cr_hfq`（后复权）
   * `cr_qfq`（前复权）

---

## 8. 情绪与能量潮类指标

衡量买卖双方力量对比、场内资金流动情况。

1. **BRAR 情绪指标**

   * `brar_ar_bfq`、`brar_br_bfq`（不复权）
   * `brar_ar_hfq`、`brar_br_hfq`（后复权）
   * `brar_ar_qfq`、`brar_br_qfq`（前复权）

2. **能量潮指标（OBV）**

   * `obv_bfq`（不复权）
   * `obv_hfq`（后复权）
   * `obv_qfq`（前复权）

3. **动量资金流向（MFI）**

   * `mfi_bfq`（不复权）
   * `mfi_hfq`（后复权）
   * `mfi_qfq`（前复权）

4. **VR 容量比率**

   * `vr_bfq`（不复权）
   * `vr_hfq`（后复权）
   * `vr_qfq`（前复权）

---

## 9. 其他常用综合指标

1. **ASI / ASIT 振动升降指标**

   * `asi_bfq`、`asit_bfq`（不复权）
   * `asi_hfq`、`asit_hfq`（后复权）
   * `asi_qfq`、`asit_qfq`（前复权）
2. **MACD 系列**

   * `macd_bfq`、`macd_dif_bfq`、`macd_dea_bfq`（不复权）
   * `macd_hfq`、`macd_dif_hfq`、`macd_dea_hfq`（后复权）
   * `macd_qfq`、`macd_dif_qfq`、`macd_dea_qfq`（前复权）

---

### 选用建议

1. **复权方式**：在中长期回测或建模时，优先使用“后复权”（带 `_hfq` 后缀）的价格与技术指标，以保持历史行情连贯性；若对特定策略要求严格参照“前复权”，也可选用 `_qfq`。日内策略或仅对当日数据做择时，则可考虑“不复权”（无后缀或 `_bfq`）数据。
2. **因子去重**：许多指标在表中同时给出了“不复权/后复权/前复权”三个版本，若只需要一种复权方式，可在列时只保留该复权列，避免冗余。
3. **时序衔接**：绝大多数技术指标需要基于价格序列的历史计算，使用时要确保按日期顺序计算与回填。
4. **归一化/标准化**：不同因子的量纲和分布差异较大，模型接入前应先做归一化或 Z-score 标准化，以提高训练效果。
5. **因子选择**：可根据策略风格（趋势、反转、动量、套利等）有针对性地从上述类别中挑选、交叉使用。例如做趋势跟踪可重点关注 MA、EMA、DMI、BBI；做动量反转则可侧重 RSI、KDJ、ROC、MTM、CCI 等震荡指标。

---

综上所述，该表几乎涵盖了主流的**价格类、成交量类、基本面估值类、股本市值类、连续交易行为类**以及**各大流行技术指标——趋势类、震荡/动量类、波动率类、通道类、成交量/情绪类**。在真正构建量化模型时，可结合策略目标与特性（如趋势、中短期反转、择时等），从上述分类中挑选对应的因子进行预处理、去极值、标准化后纳入训练。


LSTM（长短期记忆网络）是一种针对时序数据建模的深度学习结构，完全可以用于利用上述因子对股票走势（如收盘价、涨跌幅、涨跌方向等）进行预测。下面分几个方面给出较为系统的建议，供你在实践中参考。

---

## 一、明确预测目标

1. **预测变量的选择**

   * **价格预测**：直接用 LSTM 预测未来某一天的收盘价（close\_hfq）或前复权收盘价（close\_qfq）。
   * **收益率/涨跌幅预测**：更常见的是预测下一个交易日的收益率（\$r\_t=\frac{close\_t - close\_{t-1}}{close\_{t-1}}\$）或涨跌幅（pct\_chg）。这样模型对价格尺度更稳定。
   * **方向性分类**：若策略只需要判断“涨/跌”方向，可将标签二值化为 0/1 分类问题，用 LSTM 输出涨跌概率。

2. **预测步长**

   * **单步预测（One-step）**：一般先尝试用前 N 天的因子序列预测下一个交易日值。
   * **多步预测（Multi-step）**：若需要预测未来 k 天，可让模型输出一个长度为 k 的序列，但同时需要注意误差累积。

---

## 二、因子选取与预处理

1. **剔除多余或高度相关的因子**

   * 虽然表中涵盖了上百个技术指标，但并非全部都对 LSTM 有帮助。可先用相关性分析（如皮尔逊相关系数）或基于树模型的特征重要性，粗略筛选出对目标变量影响较大的那部分因子。
   * 同时要警惕多重共线性，例如 `ma_hfq_5`、`ema_hfq_5`、`ma_hfq_10` 等移动平均线之间可能高度相关，可酌情保留其中一个或做 PCA 降维。

2. **缺失值处理**

   * 部分因子计算可能在标的上市初期或停牌日出现缺失。可采取：

     * 向前/向后填充（ffill/bfill），但要小心停止信号；
     * 删除缺失比例较高的因子或行；
     * 使用均值/中位数填充（风险：可能引入偏差）。
   * 建议先检查每个因子在训练区间的缺失比例，如果某些因子缺失过多，可考虑直接舍弃。

3. **归一化 / 标准化**

   * LSTM 对数值尺度敏感，所有输入因子都应做归一化（Min-Max）或 Z-score 标准化（\$\frac{x-\mu}{\sigma}\$）。
   * **注意**：归一化/标准化参数（均值、标准差、最小值、最大值）必须仅在训练集上计算，然后同样参数应用到验证集和测试集，避免**数据泄露**（look-ahead bias）。

4. **滑窗构造时序样本**

   * 假设我们选定窗口长度为 \$T\$（例如 20\~60 个交易日），则对每支股票按时间顺序做滑动窗口采样：

     * 第一个样本：使用第 1～\$T\$ 天的因子作为输入特征，预测第 \$T+1\$ 天的标签；
     * 第二个样本：使用第 2～\$T+1\$ 天的因子，预测第 \$T+2\$ 天的标签；
     * 以此类推。
   * \$T\$ 的取值要与策略周期匹配：若做短线（1-5 天），可选 \$T=10\$~~20；做中长线（20~~60 天），可选 \$T=30$\~60。最好多尝试不同滑窗长度，对比验证集效果。

5. **训练/验证/测试集划分**

   * 股票数据本质上是时序数据，建议按时间顺序划分：

     1. **训练集**：早期大部分样本，如 2015–2022 年；
     2. **验证集**：中间一小段时间，如 2023 年部分数据；
     3. **测试集**：最新数据，如 2024–2025 年，以检验模型的真正泛化能力。
   * 切忌随机打乱时间顺序，否则会造成未来数据泄露到过去时训练中。

---

## 三、LSTM 模型架构与超参数

1. **输入与输出维度**

   * **输入维度**：滑窗长度 \$T\$ × 选定因子数量 \$F\$。
   * **输出维度**：

     * 单步回归：1（如下日收益率）
     * 单步分类：1（涨/跌），可搭配 Sigmoid；
     * 多步输出：如果要一次预测未来 \$k\$ 天，就输出维度为 \$k\$。

2. **网络结构示例**

   ```text
   Input (batch_size, T, F)
     ↓
   LSTM 层（可以堆叠多层或使用双向 LSTM）  
     ↓
   Dropout（可选，防止过拟合，p≈0.2~0.5）  
     ↓
   LSTM 层（多层时使用）或直接全连接  
     ↓
   全连接层（Dense） → 输出
   ```

   * **隐藏层单元数**：通常从 32、64、128、256 等尝试；过大容易过拟合、过小则欠拟合。
   * **层数**：1\~3 层 LSTM 即可。若层数太深，参数急剧增多，会导致训练不稳定。

3. **激活函数与损失函数**

   * **回归任务**：最后一层用线性激活，损失函数常用 MSE（均方误差）或 MAE（平均绝对误差）。
   * **分类任务**：最后一层用 Sigmoid（输出单个涨跌概率）或 Softmax（多个类别），损失函数用二元交叉熵（Binary Crossentropy）或多元交叉熵（Categorical Crossentropy）。

4. **优化器与学习率**

   * 常用 Adam 优化器（学习率 \$\alpha\$ 可从 \$1e!-!3\$ 开始尝试），再根据验证集曲线调整到 \$1e!-!4$\~\$5e!-!4\$。
   * 可在训练中加入学习率衰减（Learning Rate Scheduler），如 ReduceLROnPlateau，当验证损失不再下降时降低学习率。

5. **正则化与防过拟合**

   * **Dropout**：在 LSTM 层间或 LSTM→Dense 之间加 Dropout（常用 0.2\~0.5）。
   * **L2 正则化**：可对全连接层权重添加 L2 penalty。
   * **早停（Early Stopping）**：监控验证集损失，在连续若干个 epoch（如 5\~10 个）不再改进时提前停止训练，并恢复最佳模型。

---

## 四、训练细节与技巧

1. **批量大小（Batch Size）**

   * 对于 LSTM，Batch Size 常设为 32、64、128 等，太大或太小都会影响收敛与内存。具体需结合硬件和训练速度平衡。

2. **时间序列交叉验证**

   * 除了简单划分训练/验证/测试，还可使用滚动窗交叉验证（Walk-Forward Validation）：

     * 从最早的若干个月做第一次训练集 → 验证集；
     * 每次向后滑动一段时间，再重新训练或微调模型，再做下一轮验证；
     * 最终用多轮验证的平均指标评估模型稳定性。

3. **特征窗口组合**

   * 为了捕捉短期与中长期特征，可以将原始因子做多种滑窗统计（如过去 5 日均值、10 日均值、20 日标准差等）后再输入到 LSTM，使模型有更多“多时间尺度”信息。
   * 也可对不同类型因子（基础价格、成交量、技术指标）分别做通道输入，通过并行 LSTM 分支后再拼接。

4. **目标变量滞后与对齐**

   * 如果预测“下日涨跌”，确保当日所有输入因子均只使用当天及更早数据，不要使用下日或未来的任何衍生指标，避免“标签泄露”。

5. **样本不平衡处理（针对分类）**

   * 若涨跌方向分类中“上涨”样本和“下跌”样本比例严重失衡，可：

     * 过采样（如 SMOTE）或欠采样；
     * 在损失函数中引入权重（class\_weight），对少数类加大损失惩罚。

---

## 五、模型评估与回测

1. **评估指标**

   * **回归任务**：MSE、MAE、RMSE、\$R^2\$ 等。
   * **分类任务**：准确率（Accuracy）、F1-score、AUC（ROC 曲线下面积）等。
   * **金融特有指标**：如果最终目的是构建实盘策略，则需结合回测指标，如净值曲线、夏普率（Sharpe Ratio）、最大回撤（Max Drawdown）、胜率等。在验证阶段可简单做假设性买入卖出，观察模型信号对应未来收益。

2. **滑点与交易成本**

   * 在做策略回测时要考虑交易成本、滑点影响，避免模型“表面上”效果很好，但实盘收益被成本吞噬。

3. **多次随机初始化**

   * 由于深度学习模型结果存在随机性，应多次（如 5\~10 次）不同随机种子训练，然后取平均或选最优，保证结果鲁棒。

---

## 六、常见挑战与改进思路

1. **过拟合风险**

   * LSTM 参数众多，样本数量相对有限时容易过拟合。可重点关注：

     * 扩充样本：多标的（多只股票）同时训练，或使用指数类标的。
     * 严格正则化、剪枝（Pruning）、减少网络层数/神经元数。
     * 采用早停、Dropout、L2 正则化。

2. **特征滞后**

   * 有些技术指标本身就包含了未来信息（如 Bollinger 布林带的某些计算可能引入未来极值），要确认这些指标在训练中不会看见“未来”数据。使用时统一以“后复权”版本，且按历史时序计算并对齐。

3. **高维稀疏性能问题**

   * 上述因子超过 200 个，直接全部抛给 LSTM 容易导致维度太高，训练缓慢且易过拟合。可以考虑：

     * 先用 PCA、因子分解或 Tree-based 特征选择（如随机森林、XGBoost）选出 Top-N 个因子；
     * 或者做低维嵌入（Autoencoder）提取主成分后再做 LSTM。

4. **模型融合**

   * LSTM 只是时序建模的一种思路，也可尝试与其他模型结合：

     * **LSTM + Attention**：给序列不同时间步赋予不同权重；
     * **Bi-LSTM**：双向 LSTM，通过前后文并行捕捉更丰富信息；
     * **CNN-LSTM**：先用一维卷积提取局部特征，再接 LSTM 做长期依赖；
     * **XGBoost/CatBoost + LSTM**：先用树模型筛选特征或部分预测，然后与 LSTM 输出融合。

5. **外部信息融合**

   * 除了技术面因子，还可考虑融入**基本面**（如财务报表、财务倍数变化）、**舆情数据**（新闻情绪、社交媒体讨论热度）等多模态信息，搭建更全面的时序输入。

---

## 七、实践示例（思路示范）

1. **数据准备**

   * 从 `stock_factor_pro` 中选择若干后复权因子（如 `open_hfq`、`high_hfq`、`low_hfq`、`close_hfq`、`vol`、`turnover_rate`、`rsi_hfq_6`、`macd_hfq`、`ma_hfq_20` 等 20–30 个关键因子）。
   * 按 `ts_code + trade_date` 排序后，对每只股票生成滑窗样本。
   * 计算标签：如用第 \$T+1\$ 日的收益率 \$\text{pct\_chg}*{t+1}\$ 作为回归目标，或将 \$\text{pct\_chg}*{t+1} > 0\$ 作为分类目标。

2. **模型架构**

   ```python
   model = Sequential()
   model.add(LSTM(units=128, input_shape=(T, F), return_sequences=True))
   model.add(Dropout(0.3))
   model.add(LSTM(units=64))
   model.add(Dropout(0.3))
   model.add(Dense(units=1, activation='linear'))  # 回归
   ```

   * 编译：`model.compile(optimizer=Adam(lr=1e-3), loss='mse')`
   * 训练：`model.fit(train_X, train_y, batch_size=64, epochs=100, validation_data=(val_X,val_y), callbacks=[EarlyStopping(...), ReduceLROnPlateau(...)])`

3. **验证与调优**

   * 监控验证集 MSE/MAE 下降，如果出现过拟合则降低网络复杂度或增大 Dropout。
   * 调整滑窗长度、隐藏单元数、学习率、Batch Size 等超参数。
   * 使用滚动验证，对比不同时间段的模型稳定性。

4. **策略回测**

   * 令预测收益率大于某阈值（如 0.5%）时建仓，持有至次日收盘或直到信号反转。
   * 计算年化收益、夏普率、最大回撤等指标，检验实盘可行性。

---

## 总结

* **可行性**：上述多维度技术因子与 LSTM 结合，有望捕捉价格的时序特征，但结果高度依赖：因子质量、数据清洗、模型正则化与超参数调优。
* **关键点**：

  1. **因子筛选与预处理**：去除高度冗余、处理缺失、归一化。
  2. **滑窗设计与标签定义**：确保没有未来数据泄露；标签设计要与策略目标一致（回归 vs 分类）。
  3. **网络结构与正则化**：适度深度、不盲目加大参数量；EarlyStopping、Dropout、L2 正则化等需齐备。
  4. **时间序列验证**：保留不同年份的测试集或滚动验证，检验模型的真正泛化能力。
  5. **回测考量**：将预测信号落到实盘买卖策略中，测算交易成本与滑点后的净收益，才能判断模型价值。

如果你是初次尝试，可先选取相对常用的 20–30 个关键因子（如移动平均、MACD、RSI、成交量、换手率），跑通一个最简 LSTM 回归/分类流程；待基础框架搭建完成后，再逐渐扩充因子、改进模型结构、加入更复杂的正则与验证流程。祝你建模顺利！
